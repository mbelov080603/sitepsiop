# PSIOP Landing ‚Äì –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é

–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é Flask-–ª–µ–Ω–¥–∏–Ω–≥–∞ PSIOP –≤ Docker –Ω–∞ macOS –∏–ª–∏ Linux-—Å–µ—Ä–≤–µ—Ä–µ.

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å:

1. **Docker** (–≤–µ—Ä—Å–∏—è 20.10 –∏–ª–∏ –≤—ã—à–µ)
   - –ù–∞ **macOS**: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Docker Desktop](https://www.docker.com/products/docker-desktop/)
   - –ù–∞ **Linux**: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker Engine —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∏–ª–∏ –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã
   - **–ï—Å–ª–∏ Docker —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —ç—Ç–æ—Ç —à–∞–≥ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å**

2. **Docker Compose**
   - –í Docker Desktop (macOS/Windows) –æ–Ω —É–∂–µ –≤–∫–ª—é—á—ë–Ω
   - –ù–∞ Linux –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ: `docker compose version` –∏–ª–∏ `docker-compose --version`

3. **–û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç 80** (–¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ)
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 80 –æ—Ç–∫—Ä—ã—Ç –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ

4. **Git** –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker Desktop –Ω–∞ macOS:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **Docker Desktop**
2. –î–æ–∂–¥–∏—Ç–µ—Å—å, –ø–æ–∫–∞ –∏–∫–æ–Ω–∫–∞ Docker –≤ —Å—Ç—Ä–æ–∫–µ –º–µ–Ω—é –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –∞–Ω–∏–º–∏—Ä–æ–≤–∞—Ç—å—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –∫–æ–º–∞–Ω–¥–æ–π:

```bash
docker --version
docker ps
```

–ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫, Docker –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.

**–í–∞–∂–Ω–æ:** –ù–∞ macOS Docker Desktop –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏. –í—ã –º–æ–∂–µ—Ç–µ –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö: Docker Desktop ‚Üí Settings ‚Üí General ‚Üí Start Docker Desktop when you log in.

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/USER/psiop_landing.git
cd psiop_landing
```

–ó–∞–º–µ–Ω–∏—Ç–µ `USER/psiop_landing` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é.

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:

```
psiop_landing/
  ‚îú‚îÄ‚îÄ app.py
  ‚îú‚îÄ‚îÄ requirements.txt
  ‚îú‚îÄ‚îÄ Dockerfile
  ‚îú‚îÄ‚îÄ .dockerignore
  ‚îú‚îÄ‚îÄ docker-compose.yml
  ‚îú‚îÄ‚îÄ nginx/
  ‚îÇ   ‚îî‚îÄ‚îÄ psiop.conf
  ‚îú‚îÄ‚îÄ templates/
  ‚îÇ   ‚îú‚îÄ‚îÄ base.html
  ‚îÇ   ‚îî‚îÄ‚îÄ index.html
  ‚îî‚îÄ‚îÄ static/
      ‚îú‚îÄ‚îÄ css/
      ‚îÇ   ‚îî‚îÄ‚îÄ styles.css
      ‚îî‚îÄ‚îÄ js/
          ‚îî‚îÄ‚îÄ main.js
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ nginx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –≤—ã –¥–µ–ø–ª–æ–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –¥–æ–º–µ–Ω–æ–º, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `nginx/psiop.conf`:

```nginx
server_name example.com www.example.com;
```

–ó–∞–º–µ–Ω–∏—Ç–µ `example.com` –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω.

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:

```nginx
server_name localhost;
```

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker compose up -d --build
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è docker-compose (—Å –¥–µ—Ñ–∏—Å–æ–º), –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
docker-compose up -d --build
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:
- –°–æ–±–µ—Ä—ë—Ç Docker-–æ–±—Ä–∞–∑ –¥–ª—è Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ Dockerfile
- –ó–∞–ø—É—Å—Ç–∏—Ç –¥–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `psiop_web` (Flask + gunicorn) –∏ `psiop_nginx` (nginx reverse proxy)
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker ps
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –¥–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `Up`:
- `psiop_web`
- `psiop_nginx`

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

- **–õ–æ–∫–∞–ª—å–Ω–æ –Ω–∞ macOS:** [http://localhost/](http://localhost/)
- **–ù–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ:** `http://IP_–í–ê–®–ï–ì–û_–°–ï–†–í–ï–†–ê/`

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–µ–Ω–¥–∏–Ω–≥–∞ PSIOP.

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π –æ–±—Ä–∞–∑–∞

–ö–æ–≥–¥–∞ –≤—ã –≤–Ω–µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥:

```bash
git pull
docker compose up -d --build
```

–≠—Ç–æ –ø–µ—Ä–µ—Å–æ–±–µ—Ä—ë—Ç –æ–±—Ä–∞–∑ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º.

### –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏

–ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è):

```bash
docker compose restart web
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ nginx

–ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é nginx:

```bash
docker compose restart nginx
```

---

## –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
docker compose logs -f web
```

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ nginx:

```bash
docker compose logs -f nginx
```

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

```bash
docker compose logs -f
```

–§–ª–∞–≥ `-f` –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è (tail). –î–ª—è –≤—ã—Ö–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ `Ctrl+C`.

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤

```bash
docker compose logs --tail=100 web
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

–î–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

```bash
docker compose restart
```

–î–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```bash
docker compose restart web
docker compose restart nginx
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è:

```bash
docker compose stop
```

–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
docker compose down
```

–û—Å—Ç–∞–Ω–æ–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –æ–±—Ä–∞–∑–æ–≤:

```bash
docker compose down --rmi all
```

### –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
# Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker exec -it psiop_web bash

# nginx
docker exec -it psiop_nginx sh
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
docker stats
```

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å–µ–∫—Ä–µ—Ç—ã

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–µ–π—á–∞—Å –≤ `docker-compose.yml` –∑–∞–¥–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```yaml
environment:
  - FLASK_ENV=production
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ .env —Ñ–∞–π–ª

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –≤–∞—à–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç—ã (API-–∫–ª—é—á–∏, –ø–∞—Ä–æ–ª–∏ –∫ –ë–î –∏ —Ç.–¥.), **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ docker-compose.yml**.

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# .env
SECRET_KEY=your_secret_key_here
DATABASE_URL=postgresql://user:pass@host/db
API_KEY=your_api_key_here
```

#### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ .env –≤ .gitignore

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env` –µ—Å—Ç—å –≤ `.gitignore`, —á—Ç–æ–±—ã —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π:

```gitignore
.env
```

#### –®–∞–≥ 3: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ .env –∫ —Å–µ—Ä–≤–∏—Å—É

–ò–∑–º–µ–Ω–∏—Ç–µ `docker-compose.yml`:

```yaml
services:
  web:
    build: .
    container_name: psiop_web
    restart: always
    env_file:
      - .env
    environment:
      - FLASK_ENV=production
    ...
```

–¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env` –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ `os.environ.get()`.

---

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ HTTPS (SSL/TLS)

–ù–∞ —Ç–µ–∫—É—â–µ–º —ç—Ç–∞–ø–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ HTTP (–ø–æ—Ä—Ç 80). –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è HTTPS –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í–Ω–µ—à–Ω–∏–π reverse proxy —Å Let's Encrypt

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π nginx —Å certbot:

1. Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Let's Encrypt
2. –í–Ω–µ—à–Ω–∏–π nginx –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç—ã 80 –∏ 443
3. –û–Ω –±—É–¥–µ—Ç —Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å TLS –∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤–∞—à Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä nginx

–≠—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É–∂–µ –µ—Å—Ç—å nginx –∏–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å SSL –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Docker.

### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker-—Ä–µ—à–µ–Ω–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º SSL

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:

- [nginx-proxy](https://github.com/nginx-proxy/nginx-proxy) + [acme-companion](https://github.com/nginx-proxy/acme-companion)
- [Traefik](https://traefik.io/) —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

–≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è —Å Docker Compose –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ TLS –≤ nginx-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

1. –ü–æ–ª—É—á–∏—Ç–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (—á–µ—Ä–µ–∑ certbot –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±)
2. –°–º–æ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ nginx-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ volumes
3. –û–±–Ω–æ–≤–∏—Ç–µ `nginx/psiop.conf` –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø–æ HTTPS:

```nginx
server {
    listen 443 ssl http2;
    server_name example.com;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
}

server {
    listen 80;
    server_name example.com;
    return 301 https://$server_name$request_uri;
}
```

4. –î–æ–±–∞–≤—å—Ç–µ –≤ `docker-compose.yml`:

```yaml
nginx:
  ports:
    - "80:80"
    - "443:443"
  volumes:
    - ./nginx/psiop.conf:/etc/nginx/conf.d/default.conf:ro
    - ./ssl:/etc/nginx/ssl:ro
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—è–≤–æ–∫ (`leads.db`).

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ñ–∞–π–ª `leads.db` —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ **–±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω** –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞.

–ß—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker volume:

1. –ò–∑–º–µ–Ω–∏—Ç–µ `docker-compose.yml`:

```yaml
services:
  web:
    build: .
    container_name: psiop_web
    restart: always
    environment:
      - FLASK_ENV=production
    expose:
      - "8000"
    volumes:
      - ./data:/app/data
    networks:
      - psiop_net
```

2. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É `data/` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
mkdir data
```

3. –û–±–Ω–æ–≤–∏—Ç–µ `app.py`, —á—Ç–æ–±—ã –±–∞–∑–∞ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å –≤ `/app/data/leads.db` –≤–º–µ—Å—Ç–æ –∫–æ—Ä–Ω—è.

–¢–µ–ø–µ—Ä—å –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ –≤ –ø–∞–ø–∫–µ `data/`.

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ production-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

1. **–£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ gunicorn workers**
   
   –í `Dockerfile` –∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
   ```dockerfile
   CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:8000", "--access-logfile", "-", "--error-logfile", "-", "app:app"]
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   
   –î–æ–±–∞–≤—å—Ç–µ —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤ nginx –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è Flask.

3. **–î–æ–±–∞–≤—å—Ç–µ health checks**
   
   –í `docker-compose.yml`:
   ```yaml
   web:
     healthcheck:
       test: ["CMD", "curl", "-f", "http://localhost:8000/"]
       interval: 30s
       timeout: 10s
       retries: 3
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤**
   
   ```yaml
   web:
     deploy:
       resources:
         limits:
           cpus: '1'
           memory: 512M
   ```

5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ secrets –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

6. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (Prometheus, Grafana –∏ —Ç.–¥.)

7. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ –±—ç–∫–∞–ø—ã** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

## –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker system prune -a
```

**–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª–∏—Ç –≤—Å–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ —Å–µ—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é.

### –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker container prune
```

### –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤

```bash
docker image prune -a
```

---

## Troubleshooting (–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º)

### –ü—Ä–æ–±–ª–µ–º–∞: "Cannot connect to the Docker daemon"

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop –∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å –µ–≥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.

### –ü—Ä–æ–±–ª–µ–º–∞: "Port 80 already in use"

**–†–µ—à–µ–Ω–∏–µ:** –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥—Ä—É–≥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ –ø–æ—Ä—Ç 80, –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ docker-compose.yml:

```yaml
nginx:
  ports:
    - "8080:80"  # –¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ http://localhost:8080
```

### –ü—Ä–æ–±–ª–µ–º–∞: "502 Bad Gateway" –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–∞–π—Ç–∞

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `web` –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
2. gunicorn –Ω–µ —Å–º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
docker compose logs web
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ Python.

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑:
```bash
docker compose up -d --build
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker volumes (—Å–º. —Ä–∞–∑–¥–µ–ª "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite" –≤—ã—à–µ).

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Docker Documentation](https://docs.docker.com/)
- [Docker Compose Documentation](https://docs.docker.com/compose/)
- [Flask Documentation](https://flask.palletsprojects.com/)
- [Gunicorn Documentation](https://docs.gunicorn.org/)
- [Nginx Documentation](https://nginx.org/en/docs/)

---

**–£–¥–∞—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è! üöÄ**
